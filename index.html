<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScratchJr Web</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* סגנונות נוספים אם צריך */
        #stage {
            position: relative; /* חשוב! */
        }
        #character {
            position: absolute; /* חשוב! */
            cursor: grab;
            /* הוספה של transition כדי לתת תחושה יותר נעימה */
            transition: all 0.1s ease-out;
            /* הוספה כדי שהדמות תתחיל באמצע */
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="logo">ScratchJr</div>
            <div class="header-icons">
                <span class="icon">💾</span>
                <span class="icon">📄</span>
                <span class="icon">▶️</span> <!-- מצב מצגת -->
                <span class="icon">➕</span> <!-- הוסף עמוד -->
                <span class="icon">ℹ️</span> <!-- מידע על הפרויקט -->
                <span class="icon" id="grid-toggle">GRID</span> <!-- כפתור קווי GRID -->
            </div>
        </header>

        <main>
            <div class="stage-container">
                <div id="stage">
                    <!-- כאן הדמויות והרקע יוצגו -->
                    <img id="character" src="assets/images/CAT.svg" alt="Cat">
                </div>
            </div>
            <div class="palette-and-programming">

                <div id="block-palette">
                    <!-- כאן יוצגו הבלוקים השונים -->
                    <div class="category-tabs">
                        <button class="category-tab" data-category="end">
                            <img src="assets/images/end.svg" alt="End">
                        </button>
                        <button class="category-tab" data-category="control">
                            <img src="assets/images/control.svg" alt="Control">
                        </button>
                        <button class="category-tab" data-category="sound">
                            <img src="assets/images/sound.svg" alt="Sound">
                        </button>
                        <button class="category-tab" data-category="looks">
                            <img src="assets/images/looks.svg" alt="Looks">
                        </button>
                        <button class="category-tab" data-category="motion">
                            <img src="assets/images/motion.svg" alt="Motion">
                        </button>
                        <button class="category-tab active" data-category="triggering">
                            <img src="assets/images/triggering.svg" alt="Triggers">
                        </button>
                    </div>
                    <div id="end-blocks" class="block-category" data-category="end"></div>
                    <div id="control-blocks" class="block-category" data-category="control"></div>
                    <div id="sound-blocks" class="block-category" data-category="sound"></div>
                    <div id="looks-blocks" class="block-category" data-category="looks"></div>
                    <div id="motion-blocks" class="block-category" data-category="motion"></div>
                    <div id="triggering-blocks" class="block-category active" data-category="triggering"></div>

                </div>

                <div id="programming-area">
                    <!-- כאן המשתמש יגרור ויחבר בלוקים -->
                    <div class="program-header">Program <span id="clear-all">Clear All</span></div>
                    <div id="program-blocks"></div>
                </div>
            </div>
        </main>
    </div>

    <script src="js/script.js"></script>
    <script>
        const character = document.getElementById('character');
        const stage = document.getElementById('stage');
        let isDragging = false;
        let offsetX = 0;
        let offsetY = 0;

        character.addEventListener('mousedown', (e) => {
            isDragging = true;
            offsetX = e.clientX - character.getBoundingClientRect().left;
            offsetY = e.clientY - character.getBoundingClientRect().top;
            character.style.cursor = 'grabbing';
        });

        // שינוי משמעותי - הוספת Event Listener לבמה במקום ל document
        stage.addEventListener('mouseup', () => {
            isDragging = false;
            character.style.cursor = 'grab';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;

            // הגבלת התנועה לתחומי הבמה
            const stageRect = stage.getBoundingClientRect();
            let x = e.clientX - offsetX - stageRect.left;
            let y = e.clientY - offsetY - stageRect.top;

            // הגבלת הגרירה בתוך הבמה
            const characterWidth = character.offsetWidth;
            const characterHeight = character.offsetHeight;

            // תיקון מיקום ה-X
            if (x < 0) {
                x = 0;
            } else if (x + characterWidth > stageRect.width) {
                x = stageRect.width - characterWidth;
            }

            // תיקון מיקום ה-Y
            if (y < 0) {
                y = 0;
            } else if (y + characterHeight > stageRect.height) {
                y = stageRect.height - characterHeight;
            }

            character.style.left = x + 'px';
            character.style.top = y + 'px';
        });

        character.addEventListener('dragstart', (e) => {
            e.preventDefault(); // מניעת גרירת תמונה רגילה
        });
    </script>
</body>
</html>
